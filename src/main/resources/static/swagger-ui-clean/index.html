<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ë¦¬ìƒµ Swagger API - Clean Architecture</title>
    <link rel="icon" type="image/png" href="/swagger-ui/favicon.png" />
    
    <!-- External Dependencies -->
    <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist/swagger-ui.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="/swagger-ui/swagger-custom.css">
    
    <style>
        /* ë¡œë”© í™”ë©´ ìŠ¤íƒ€ì¼ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.3s ease;
        }

        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #6DB33F;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            margin-left: 16px;
            font-size: 16px;
            color: #333;
        }

        /* ì—ëŸ¬ í‘œì‹œ ìŠ¤íƒ€ì¼ */
        .error-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 32px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-width: 500px;
            text-align: center;
            z-index: 10001;
        }

        .error-title {
            color: #f44336;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 16px;
        }

        .error-message {
            color: #666;
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 24px;
        }

        .error-actions {
            display: flex;
            justify-content: center;
            gap: 12px;
        }

        .error-button {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: background-color 0.2s ease;
        }

        .error-button.primary {
            background-color: #6DB33F;
            color: white;
        }

        .error-button.primary:hover {
            background-color: #5a9635;
        }

        .error-button.secondary {
            background-color: #f5f5f5;
            color: #333;
        }

        .error-button.secondary:hover {
            background-color: #e0e0e0;
        }

        /* ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë¡œë“œë˜ê¸° ì „ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
        }

        .main-container {
            display: none; /* ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ */
        }

        /* ê°œë°œì ë„êµ¬ ì•Œë¦¼ */
        .dev-tools-notice {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2196F3;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 9999;
            display: none;
        }
    </style>
</head>
<body>
    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Swagger UI ë¡œë”© ì¤‘...</div>
    </div>

    <!-- ì—ëŸ¬ í‘œì‹œ -->
    <div id="error-container" class="error-container">
        <div class="error-title">ì´ˆê¸°í™” ì˜¤ë¥˜</div>
        <div id="error-message" class="error-message">
            ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì´ˆê¸°í™”í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
        </div>
        <div class="error-actions">
            <button class="error-button primary" onclick="location.reload()">
                í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
            </button>
            <button class="error-button secondary" onclick="showErrorDetails()">
                ìì„¸íˆ ë³´ê¸°
            </button>
        </div>
    </div>

    <!-- ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…Œì´ë„ˆ -->
    <div class="main-container" id="main-container" style="flex-direction: row">
        <!-- ë„êµ¬ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ -->
        <div class="swagger-tool-container">
            <div id="new-api-counter" class="swagger-tool-btn" style="background-color: #6F42C1; cursor: default;">
                NEW API: 0ê°œ
            </div>
            <button id="refresh-page-btn" class="swagger-tool-btn">ìƒˆë¡œê³ ì¹¨</button>
            <button id="reset-localstorage-btn" class="swagger-tool-btn">ğŸ—‘ï¸ LocalStorage ì´ˆê¸°í™”</button>
            <button id="reset-cookie-btn" class="swagger-tool-btn">ğŸª ì¿ í‚¤ ì´ˆê¸°í™”</button>
        </div>

        <!-- ì‚¬ì´ë“œë°” -->
        <nav class="sidebar">
            <div class="empty" id="empyt-box" style="padding-left: 20px; flex-direction: row">
                <div class="sidebar-content">
                    <div class="sidebat-title">
                        <h3 class="custom-api-title">ë¶ë§ˆí¬&nbsp;&nbsp;</h3>
                        <span id="settings-btn" class="material-symbols-outlined">settings</span>
                    </div>
                    <ul id="custom-api-tree">
                        <li id="custom-api-tree-main-test">API ë¶ë§ˆí¬</li>
                    </ul>
                    <h3>API ê·¸ë£¹</h3>
                    <ul id="api-tree"></ul>
                </div>
            </div>
        </nav>

        <!-- ì‚¬ì´ë“œë°” í† ê¸€ ë²„íŠ¼ -->
        <button id="toggle-sidebar-btn">â˜°</button>

        <!-- ë©”ì¸ Swagger UI ì˜ì—­ -->
        <section id="swagger-ui"></section>
    </div>

    <!-- ë¶ë§ˆí¬ ëª¨ë‹¬ -->
    <div id="modal-overlay" class="hidden">
        <div id="modal">
            <h2 class="modal-title">API ë¶ë§ˆí¬</h2>

            <div class="modal-top">
                <div class="modal-left-wrapper">
                    <h3 class="section-title">íƒœê·¸ì´ë¦„</h3>
                    <div class="modal-left" id="category-list" flex-direction="column">
                        <!-- ë™ì  ìƒì„± ì˜ì—­ -->
                    </div>
                </div>

                <div class="modal-right-wrapper">
                    <h3 class="section-title">API ì—”ë“œí¬ì¸íŠ¸</h3>
                    <div class="modal-right" id="subcategory-list">
                        <!-- ë™ì  ìƒì„± ì˜ì—­ -->
                    </div>
                </div>
            </div>

            <div class="modal-bottom-wrapper">
                <h3 class="section-title">ì„ íƒëœ í•­ëª©</h3>
                <div class="modal-bottom" id="selected-subcategories">
                    <!-- ë™ì  ìƒì„± ì˜ì—­ -->
                </div>
            </div>

            <div class="modal-buttons">
                <button id="closed-modal" class="cancel-btn">ì·¨ì†Œ</button>
                <button id="save-modal" class="confirm-btn">í™•ì¸</button>
            </div>
        </div>
    </div>

    <!-- ê°œë°œì ë„êµ¬ ì•Œë¦¼ -->
    <div id="dev-tools-notice" class="dev-tools-notice">
        ê°œë°œì ëª¨ë“œê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤. window.SwaggerAppìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </div>

    <!-- External Scripts -->
    <script src="https://unpkg.com/swagger-ui-dist/swagger-ui-bundle.js"></script>

    <!-- ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì  -->
    <script type="module" src="./main.js"></script>

    <script>
        // ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬
        window.addEventListener('error', function(event) {
            console.error('Global error:', event.error);
            showError('ìŠ¤í¬ë¦½íŠ¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + event.error.message);
        });

        window.addEventListener('unhandledrejection', function(event) {
            console.error('Unhandled promise rejection:', event.reason);
            showError('ë¹„ë™ê¸° ì‘ì—… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        });

        // ì—ëŸ¬ í‘œì‹œ í•¨ìˆ˜
        function showError(message) {
            const loadingOverlay = document.getElementById('loading-overlay');
            const errorContainer = document.getElementById('error-container');
            const errorMessage = document.getElementById('error-message');

            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
            }

            if (errorMessage) {
                errorMessage.textContent = message;
            }

            if (errorContainer) {
                errorContainer.style.display = 'block';
            }
        }

        // ì—ëŸ¬ ìƒì„¸ í‘œì‹œ
        function showErrorDetails() {
            const details = {
                userAgent: navigator.userAgent,
                url: location.href,
                timestamp: new Date().toISOString(),
                localStorage: !!window.localStorage,
                sessionStorage: !!window.sessionStorage,
                cookies: document.cookie ? 'enabled' : 'disabled'
            };

            const detailsText = Object.entries(details)
                .map(([key, value]) => `${key}: ${value}`)
                .join('\n');

            alert('ì‹œìŠ¤í…œ ì •ë³´:\n\n' + detailsText);
        }

        // ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œë”© ì™„ë£Œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.addEventListener('DOMContentLoaded', function() {
            // ê°œë°œ í™˜ê²½ì—ì„œ ê°œë°œì ë„êµ¬ ì•Œë¦¼ í‘œì‹œ
            if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
                setTimeout(() => {
                    const notice = document.getElementById('dev-tools-notice');
                    if (notice) {
                        notice.style.display = 'block';
                        setTimeout(() => {
                            notice.style.display = 'none';
                        }, 5000);
                    }
                }, 2000);
            }
        });

        // ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” ì™„ë£Œ í›„ í˜¸ì¶œë  í•¨ìˆ˜
        window.onSwaggerAppReady = function() {
            const loadingOverlay = document.getElementById('loading-overlay');
            const mainContainer = document.getElementById('main-container');

            if (loadingOverlay) {
                loadingOverlay.classList.add('hidden');
                setTimeout(() => {
                    loadingOverlay.style.display = 'none';
                }, 300);
            }

            if (mainContainer) {
                mainContainer.style.display = 'flex';
            }

            console.log('âœ… Swagger UI Clean Architecture loaded successfully');
        };

        // ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” ì‹¤íŒ¨ ì‹œ í˜¸ì¶œë  í•¨ìˆ˜
        window.onSwaggerAppError = function(error) {
            showError(error.message || 'ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        };

        // ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ì²´í¬
        function checkBrowserCompatibility() {
            const isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
            const isFirefox = /Firefox/.test(navigator.userAgent);
            const isSafari = /Safari/.test(navigator.userAgent) && /Apple Computer/.test(navigator.vendor);
            const isEdge = /Edge/.test(navigator.userAgent);

            const isModernBrowser = isChrome || isFirefox || isSafari || isEdge;
            const supportsModules = 'noModule' in HTMLScriptElement.prototype;
            const supportsES6 = (function() {
                try {
                    new Function('(a = 0) => a');
                    return true;
                } catch (err) {
                    return false;
                }
            })();

            if (!isModernBrowser || !supportsModules || !supportsES6) {
                showError('ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ìµœì‹  ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì§€ì›ë©ë‹ˆë‹¤. Chrome, Firefox, Safari, Edgeì˜ ìµœì‹  ë²„ì „ì„ ì‚¬ìš©í•´ ì£¼ì„¸ìš”.');
                return false;
            }

            return true;
        }

        // ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ì²´í¬ ì‹¤í–‰
        if (!checkBrowserCompatibility()) {
            console.warn('Browser compatibility check failed');
        }

        // ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ (ê°œë°œìš©)
        if (window.performance && window.performance.mark) {
            window.performance.mark('swagger-app-start');
            
            window.addEventListener('load', function() {
                window.performance.mark('swagger-app-loaded');
                window.performance.measure('swagger-app-load-time', 'swagger-app-start', 'swagger-app-loaded');
                
                const measure = window.performance.getEntriesByName('swagger-app-load-time')[0];
                if (measure) {
                    console.log(`ğŸš€ Swagger App load time: ${measure.duration.toFixed(2)}ms`);
                }
            });
        }
    </script>
</body>
</html>